<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒ—æµ·é“å…­äººè‡ªé§•è¡Œæ”»ç•¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .active-tab { border-bottom: 3px solid #3b82f6; color: #3b82f6; font-weight: bold; }
        .flight-group { display: none; }
        .flight-group.active { display: block; }
        .checkbox-item:checked + span { text-decoration: line-through; color: #94a3b8; }
        .category-title { border-left: 4px solid #3b82f6; padding-left: 0.75rem; margin: 1.5rem 0 0.75rem 0; color: #1e40af; font-weight: 700; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .snow-card { background: white; border-radius: 16px; padding: 16px; margin-bottom: 16px; border: 1px solid #e2e8f0; }
        .badge { width: 20px; height: 20px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-size: 10px; margin-right: 8px; font-weight: bold; color: white; }
    </style>
</head>
<body class="max-w-md mx-auto bg-white min-h-screen shadow-lg pb-24">

    <header class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 text-center shadow-md">
        <h1 class="text-2xl font-bold italic tracking-wider">åŒ—æµ·åŒ—æµ· 2026</h1>
        <p class="text-sm opacity-90 mt-1 font-medium">3/13 - 3/17 æ—¥æœ¬å…­äººè‡ªé§•é›ªåœ°å°è‹±é›„</p>
    </header>

    <nav class="flex border-b sticky top-0 bg-white z-20 shadow-sm overflow-x-auto no-scrollbar">
        <button onclick="showTab('flights')" id="btn-flights" class="flex-none px-5 py-4 text-sm font-medium active-tab">âœˆï¸ èˆªç­</button>
        <button onclick="showTab('checklist')" id="btn-checklist" class="flex-none px-5 py-4 text-sm font-medium">ğŸ“ è¡Œæ</button>
        <button onclick="showTab('airport')" id="btn-airport" class="flex-none px-5 py-4 text-sm font-medium">âš ï¸ è¦å‰‡</button>
        <button onclick="showTab('itinerary')" id="btn-itinerary" class="flex-none px-5 py-4 text-sm font-medium">ğŸ“ è¡Œç¨‹</button>
        <button onclick="showTab('splitting')" id="btn-splitting" class="flex-none px-5 py-4 text-sm font-medium">ğŸ’° åˆ†å¸³</button>
    </nav>

    <div id="flights" class="tab-content active space-y-4">
            <div class="flex p-1 bg-gray-100 rounded-lg mb-4">
                <button onclick="toggleFlightGroup('direct')" id="btn-direct" class="flex-1 py-2 text-xs font-bold rounded-md bg-white shadow-sm text-blue-600">ç›´é£›çµ„</button>
                <button onclick="toggleFlightGroup('transfer')" id="btn-transfer" class="flex-1 py-2 text-xs font-bold rounded-md text-gray-500">è½‰æ©Ÿçµ„</button>
            </div>
            <!-- Direct Group -->
            <div id="group-direct" class="flight-group active space-y-4">
                <div class="bg-blue-50 border border-blue-100 rounded-2xl p-4 shadow-sm">
                    <h3 class="font-bold text-blue-800 mb-2">å»ç¨‹ï¼šé…·èˆª TR 892</h3>
                    <p class="text-[10px] font-bold text-blue-500 mb-2 uppercase tracking-widest">3æœˆ13æ—¥ (äº”)</p>
                    <div class="flex justify-between items-center bg-white p-3 rounded-xl shadow-inner mb-2 border border-blue-100">
                        <div class="text-center">
                            <span class="block font-black text-xl">06:20</span>
                            <span class="text-[10px] text-gray-400">TPE æ¡ƒåœ’ T1</span>
                        </div>
                        <div class="text-blue-300 text-lg">âœˆï¸</div>
                        <div class="text-center">
                            <span class="block font-black text-xl">11:00</span>
                            <span class="text-[10px] text-gray-400">CTS æ–°åƒæ­²</span>
                        </div>
                    </div>
                    <p class="text-[10px] text-red-500 font-black bg-red-50 p-2 rounded text-center">ğŸš¨ 04:30 ä»¥å‰éœ€æŠµé” T1 æ«ƒæª¯å ±åˆ°</p>
                </div>

                <div class="bg-slate-50 border border-slate-200 rounded-2xl p-4 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-2">å›ç¨‹ï¼šé…·èˆª TR 893</h3>
                    <p class="text-[10px] font-bold text-slate-500 mb-2 uppercase tracking-widest">3æœˆ17æ—¥ (äºŒ)</p>
                    <div class="flex justify-between items-center bg-white p-3 rounded-xl shadow-inner mb-2 border border-slate-100">
                        <div class="text-center">
                            <span class="block font-black text-xl">18:40</span>
                            <span class="text-[10px] text-gray-400">CTS æ–°åƒæ­²</span>
                        </div>
                        <div class="text-slate-300 text-lg">âœˆï¸</div>
                        <div class="text-center">
                            <span class="block font-black text-xl">22:15</span>
                            <span class="text-[10px] text-gray-400">TPE æ¡ƒåœ’ T1</span>
                        </div>
                    </div>
                    <p class="text-[10px] text-red-500 font-black bg-red-50 p-2 rounded text-center">ğŸš¨ 16:20 ä»¥å‰éœ€æŠµé”æ«ƒæª¯å ±åˆ°</p>
                </div>
            </div>

            <!-- Transfer Group -->
            <div id="group-transfer" class="flight-group space-y-4">
                <div class="bg-blue-50 border border-blue-200 rounded-2xl p-4 shadow-sm relative overflow-hidden">
                    <div class="absolute right-0 top-0 bg-blue-600 text-white text-[9px] px-3 py-1 font-bold">å»ç¨‹ 1/2</div>
                    <h3 class="font-bold text-blue-800 mb-1">é…·èˆª TR 874</h3>
                    <p class="text-[10px] font-bold text-blue-500 mb-2">3æœˆ12æ—¥ (å››)</p>
                    <div class="flex justify-between items-center bg-white p-3 rounded-xl shadow-inner mb-2 border border-blue-100">
                        <div class="text-center">
                            <span class="block font-black text-xl">14:00</span>
                            <span class="text-[10px] text-gray-400 font-medium">TPE æ¡ƒåœ’ T1</span>
                        </div>
                        <div class="text-blue-400">â”</div>
                        <div class="text-center">
                            <span class="block font-black text-xl">18:00</span>
                            <span class="text-[10px] text-gray-400 font-medium">HND ç¾½ç”°/æ±äº¬</span>
                        </div>
                    </div>
                    <p class="text-[10px] text-red-500 font-black bg-red-50 p-2 rounded text-center">ğŸš¨ 12:00 ä»¥å‰éœ€æŠµé”æ«ƒæª¯å ±åˆ°</p>
                </div>
                <div class="bg-indigo-50 border border-indigo-200 rounded-2xl p-4 shadow-sm relative overflow-hidden">
                    <div class="absolute right-0 top-0 bg-indigo-600 text-white text-[9px] px-3 py-1 font-bold">å»ç¨‹ 2/2</div>
                    <h3 class="font-bold text-indigo-800 mb-1">å…¨æ—¥ç©º NH 053</h3>
                    <p class="text-[10px] font-bold text-indigo-500 mb-2">3æœˆ13æ—¥ (äº”)</p>
                    <div class="flex justify-between items-center bg-white p-3 rounded-xl shadow-inner border border-indigo-100">
                        <div class="text-center">
                            <span class="block font-black text-xl">08:00</span>
                            <span class="text-[10px] text-gray-400 font-medium">HND ç¾½ç”°æ©Ÿå ´</span>
                        </div>
                        <div class="text-indigo-400">â”</div>
                        <div class="text-center">
                            <span class="block font-black text-xl">09:30</span>
                            <span class="text-[10px] text-gray-400 font-medium">CTS æ–°åƒæ­²</span>
                        </div>
                    </div>
                    <p class="text-[10px] text-red-500 font-black bg-red-50 p-2 rounded text-center">ğŸš¨ 06:30 ä»¥å‰éœ€æŠµé”æ«ƒæª¯å ±åˆ°</p>
                </div>
                <!-- è£œå›è½‰æ©Ÿçµ„å›ç¨‹ -->
                <div class="bg-slate-50 border border-slate-200 rounded-2xl p-4 shadow-sm relative overflow-hidden">
                    <div class="absolute right-0 top-0 bg-slate-600 text-white text-[9px] px-3 py-1 font-bold">å›ç¨‹</div>
                    <h3 class="font-bold text-slate-800 mb-1">é…·èˆª TR 893</h3>
                    <p class="text-[10px] font-bold text-slate-500 mb-2">3æœˆ17æ—¥ (äºŒ)</p>
                    <div class="flex justify-between items-center bg-white p-3 rounded-xl shadow-inner mb-2 border border-slate-100">
                        <div class="text-center">
                            <span class="block font-black text-xl">18:40</span>
                            <span class="text-[10px] text-gray-400 font-medium">CTS æ–°åƒæ­²</span>
                        </div>
                        <div class="text-slate-400">â”</div>
                        <div class="text-center">
                            <span class="block font-black text-xl">22:15</span>
                            <span class="text-[10px] text-gray-400 font-medium">TPE æ¡ƒåœ’ T1</span>
                        </div>
                    </div>
                    <p class="text-[10px] text-red-500 font-black bg-red-50 p-2 rounded text-center">ğŸš¨ 16:20 ä»¥å‰éœ€æŠµé” T1 æ«ƒæª¯å ±åˆ°</p>
                </div>
            </div>
        </div>


        <div id="checklist" class="tab-content">
            <h3 class="category-title">ğŸªª è­‰ä»¶èˆ‡é‡è¦ç‰©å“</h3>
            <div class="space-y-2 bg-blue-50 p-4 rounded-xl mb-4">
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">è­·ç…§ (æ­£æœ¬)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">å°ç£é§•ç…§æ­£æœ¬ + æ—¥æ–‡è­¯æœ¬ (é–‹è»Šå¿…å¸¶)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">Visit Japan Web QR Code (æˆªåœ–å‚™ä»½)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æ—¥å¹£ç¾é‡‘ + ä¿¡ç”¨å¡</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æµ·å¤–æ—…éŠä¿éšªå–®æ“š (é›»å­æª”)</span></label>
            </div>

            <h3 class="category-title">ğŸ§¥ é›ªåœ°ä¿æš–ç©¿è‘—</h3>
            <div class="space-y-2 bg-slate-50 p-4 rounded-xl mb-4 text-xs">
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">é˜²é¢¨é˜²æ°´é•·ç‰ˆå¤–å¥— (ä¿æš–å¤–å±¤)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">ç™¼ç†±è¡£ / ç¾Šæ¯›å…§å±¤ (3-4å¥—)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">é›ªé´ / é«˜æ¡¶é˜²æ»‘é˜²æ°´é‹</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æ¯›å¸½ã€åœå·¾ã€åšè¥ªå­ (ç¾Šæ¯›ä½³)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">é˜²æ°´æ‰‹å¥— (ç©é›ªå¿…å‚™)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">é‹åº•æ­¢æ»‘å¢Š (é˜²æ­¢å†°ä¸Šæ»‘å€’)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">è¼•ä¾¿èƒŒåŒ…</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æ‘ºç–Šå‚˜</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">å¤ªé™½çœ¼é¡ (é›ªç›²é é˜²)</span></label>
            </div>

            <h3 class="category-title">ğŸ”Œ é›»å­èˆ‡ç”Ÿæ´»ç”¨å“</h3>
            <div class="space-y-2 bg-amber-50 p-4 rounded-xl mb-4 text-xs">
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æ‰‹æ©Ÿ</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">è€³æ©Ÿ/è€³å¡</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">è¡Œå‹•é›»æº (ä½æº«è€—é›»å¿«)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">å¤šå­”å……é›»é ­ + å„é¡ç·šæ</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">è»Šç”¨æ‰‹æ©Ÿæ¶ + è»Šå……</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">è¨˜æ†¶å¡</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">å¥½æ¼«éŠæœå‹™/eSIM/æˆ–é ç´„ç•¶åœ° SIM å¡</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">é‹ç”¨/æ‰‹æŒæš–æš–åŒ…</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">ä¿æ¿•å™´éœ§ / ä¹³æ¶² / è­·å”‡è† (æ¥µä¹¾ç‡¥)</span></label>
            </div>

            <h3 class="category-title">ğŸ’Š å€‹äººè­·ç†ç”¨å“</h3>
            <div class="space-y-2 bg-emerald-50 p-4 rounded-xl mb-4 text-xs">
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">ç‰™åˆ·ã€ç‰™è† </span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æ´—é«®ç²¾ã€æ²æµ´ä¹³ </span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">åŒ–å¦å“/ä¿é¤Šå“ </span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">ä¹¾æ´—æ‰‹/æ¶ˆæ¯’æ¿•ç´™å·¾ </span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">é˜²æ›¬ä¹³ </span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">å¸¸å‚™è—¥ (æ­¢ç—›ã€é€€ç‡’ã€è…¸èƒƒ)</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">æšˆè»Šè—¥ </span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">OKç¹ƒ / ç°¡æ˜“æ€¥æ•‘åŒ…</span></label>
                <label class="flex items-start space-x-3"><input type="checkbox" class="checkbox-item mt-1 w-5 h-5 rounded"><span class="text-sm font-medium">éš±å½¢çœ¼é¡åŠç”¨å“ï¼ˆå¦‚éœ€è¦ï¼‰ </span></label>
            </div>
        </div>


        <div id="airport" class="tab-content space-y-4">
            <div class="bg-red-600 p-4 rounded-2xl text-white shadow-md">
                <h3 class="font-black flex items-center mb-2">ğŸš« åš´ç¦æ”œå¸¶ç‰©å“ (è¨—é‹/éš¨èº«çš†ä¸å¯)</h3>
                <ul class="text-xs space-y-2 opacity-95">
                    <li>â€¢ <strong>æ‰“ç«æ©Ÿï¼š</strong>é˜²é¢¨/é›ªèŒ„å‹æ‰“ç«æ©Ÿåš´ç¦ã€‚</li>
                    <li>â€¢ <strong>æ˜“ç‡ƒç‰©å“ï¼š</strong>éœ²ç‡Ÿç”¨ç“¦æ–¯ç½ã€å™´éœ§ç½(é™¤è‡­/é«®è† )å–®ç½è¶…é500mlã€‚</li>
                    <li>â€¢ <strong>é•ç¦å“ï¼š</strong>è‚‰é¡è£½å“ã€æ–°é®®è”¬æœã€ç¨®å­ã€‚</li>
                </ul>
            </div>
            <div class="bg-blue-600 p-4 rounded-2xl text-white shadow-md">
                <h3 class="font-black flex items-center mb-2">ğŸ’ å¿…é ˆéš¨èº«æ”œå¸¶ (ä¸å¯è¨—é‹)</h3>
                <ul class="text-xs space-y-2 opacity-95">
                    <li>â€¢ <strong>é›»æ± é¡ï¼š</strong>è¡Œå‹•é›»æºã€ç›¸æ©Ÿ/æ‰‹æ©Ÿé‹°é›»æ± ã€‚</li>
                    <li>â€¢ <strong>è²´é‡å“ï¼š</strong>ç¾é‡‘ã€ä¿¡ç”¨å¡ã€è­·ç…§ã€é§•ç…§ã€ç›¸æ©Ÿã€ç­†é›»ã€‚</li>
                    <li>â€¢ <strong>å‡ºç¤ºé¡ï¼š</strong>æ©Ÿç¥¨ã€æ©Ÿç¥¨ã€ç™»æ©Ÿè­‰ã€ç°½è­‰æ–‡ä»¶ã€æ—…éŠä¿éšªã€‚</li>
                </ul>
            </div>
            <div class="bg-emerald-600 p-4 rounded-2xl text-white shadow-md">
                <h3 class="font-black flex items-center mb-2">ğŸ§³ å¿…é ˆè¨—é‹ç‰©å“</h3>
                <ul class="text-xs space-y-2 opacity-95">
                    <li>â€¢ <strong>æ¶²é«”è¦ç¯„ï¼š</strong>å–®ä»¶è¶…é 100mlã€‚100mlä»¥ä¸‹éœ€è£æ–¼é€æ˜å¡‘è† è¢‹å…§(æ¯äººé™ä¸€è¢‹)æ–¹å¯éš¨èº«ã€‚</li>
                    <li>â€¢ <strong>å°–éŠ³ç‰©ï¼š</strong>æŒ‡ç”²å‰ªã€ä¿®çœ‰åˆ€ã€å°åˆ€ã€ç‘å£«åˆ€ã€‚</li>
                    <li>â€¢ <strong>æ£æ£’ï¼š</strong>è…³æ¶ã€è‡ªæ‹æ£’(ç¸®åˆå¾Œé•·åº¦è¶…é60cmè€…å¿…é ˆè¨—é‹)ã€‚</li>
                </ul>
            </div>
            <div class="bg-gray-100 p-3 rounded-lg text-[10px] text-gray-500">
                è¨»ï¼šè¡Œå‹•é›»æºä¸å¯æ¨™ç¤ºä¸æ¸…ã€‚æ—¥æœ¬æµ·é—œæª¢æŸ¥åš´æ ¼ï¼Œå»ºè­°å…ˆå°‡è¡Œå‹•é›»æºæ¨™ç±¤åŠ å›ºã€‚
            </div>
        </div>


        <div id="itinerary" class="tab-content space-y-6">
            <div id="itinerary-list" class="space-y-8"></div>
        </div>


        <div id="splitting" class="tab-content space-y-4">
            <div class="snow-card bg-emerald-50 border-emerald-100">
                <h3 class="font-bold text-emerald-800 mb-2 text-sm flex items-center justify-between">
                    <span><i class="fas fa-cloud mr-2"></i> é›²ç«¯åŒæ­¥ç‹€æ…‹</span>
                    <span id="sync-status" class="text-[10px] bg-white px-2 py-0.5 rounded text-gray-400">ç­‰å¾…ä¸­...</span>
                </h3>
                <div class="flex gap-2">
                    <button onclick="downloadFromCloud()" class="flex-1 bg-white border border-emerald-600 text-emerald-600 text-[11px] font-bold p-2 rounded-lg">æ‰‹å‹•æ‹‰å–</button>
                    <button onclick="uploadToCloud()" class="flex-1 bg-emerald-600 text-white text-[11px] font-bold p-2 rounded-lg">æ‰‹å‹•å‚™ä»½</button>
                </div>
            </div>

            <div class="snow-card">
                <h3 class="font-bold text-blue-800 mb-4 text-sm flex items-center"><i class="fas fa-plus-circle mr-2"></i> æ–°å¢æ”¯å‡º</h3>
                <div class="space-y-3">
                    <input type="text" id="payer" list="name-list" class="w-full p-3 border border-gray-200 rounded-xl text-sm" placeholder="ä»˜æ¬¾äºº">
                    <datalist id="name-list"></datalist>
                    <div class="flex gap-2">
                        <input type="number" id="amount" class="flex-1 p-3 border border-gray-200 rounded-xl text-sm" placeholder="é‡‘é¡" inputmode="numeric">
                        <select id="currency" class="w-24 p-3 border border-gray-200 rounded-xl text-sm bg-gray-50">
                            <option value="TWD" selected>å°å¹£</option>
                            <option value="JPY">æ—¥å¹£</option>
                        </select>
                    </div>
                    <input type="text" id="item" class="w-full p-3 border border-gray-200 rounded-xl text-sm" placeholder="é …ç›®">
                    <div id="members-area" class="flex flex-wrap gap-2 bg-slate-50 p-3 rounded-xl"></div>
                    <button onclick="addRecord()" id="add-btn" class="w-full bg-blue-600 text-white font-bold p-3 rounded-xl shadow-lg">å„²å­˜ä¸¦è‡ªå‹•å‚™ä»½</button>
                </div>
            </div>

            <div class="snow-card bg-blue-50 border-blue-100">
                <h3 class="font-bold text-blue-900 mb-3 text-sm flex items-center"><i class="fas fa-rocket mr-2"></i> æœ€çŸ­é‚„æ¬¾æ–¹æ¡ˆ (TWD)</h3>
                <div id="settlement-plan" class="space-y-2"></div>
            </div>

            <div class="snow-card">
                <h3 class="font-bold text-gray-700 mb-3 text-sm flex items-center"><i class="fas fa-crown mr-2"></i> å¢Šä»˜è²¢ç»æ’è¡Œæ¦œ</h3>
                <div id="payment-summary" class="text-xs space-y-2"></div>
            </div>

            <div class="snow-card">
                <h3 class="font-bold text-gray-700 mb-3 text-sm flex items-center"><i class="fas fa-chart-pie mr-2"></i> æœ€çµ‚æç›Š (æ‡‰æ”¶/æ‡‰ä»˜)</h3>
                <div id="personal-summary" class="text-xs space-y-2"></div>
            </div>

            <div class="snow-card bg-slate-50">
                <h3 class="font-bold text-gray-500 mb-3 text-sm flex items-center justify-between">
                    <span><i class="fas fa-history mr-2"></i> æ­·å²è¨˜éŒ„</span>
                    <button onclick="clearRecords()" class="text-red-400 font-normal text-[10px]">æ¸…ç©º</button>
                </h3>
                <div id="history-list" class="divide-y divide-gray-200"></div>
            </div>
        </div>
    </main>

    <footer class="fixed bottom-0 w-full max-w-md bg-amber-50 border-t border-amber-100 px-4 py-3 flex items-center justify-center z-30">
        <span class="text-lg">ğŸ“¢</span>
        <marquee class="text-[11px] font-bold text-amber-900" scrollamount="5">
    æé†’ï¼šæ³¨æ„éš¨èº«è¡Œæï¼Œé¿å…è¢«æµ·é—œé–‹ç®±æª¢æŸ¥ã€‚ &nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp; 
    æé†’ï¼šè«‹ç¢ºèªè­·ç…§æœ‰æ•ˆæœŸéœ€åœ¨å…­å€‹æœˆä»¥ä¸Šã€‚ &nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp; 
    æé†’ï¼šç¦æ­¢æ”œå¸¶æ–°é®®è”¬æœåŠè‚‰é¡è£½å“å…¥å¢ƒã€‚ &nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;
    æé†’ï¼šæ³¨æ„å…ç¨…é¡åº¦ï¼Œè«‹ç•™æ„è³¼è²·é‡‘é¡ã€‚ &nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;
    æé†’ï¼šç¦æ­¢åœ¨é›ªçƒå…§è—çŸ³é ­æŠ•æ“²ã€‚ &nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;
	</marquee>
    </footer>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwgmHOOhdgywLdsP3oW_5kSCwwSVtfm22Kwhj9bEFQXr1mk9XayKxTLF478sSYh623x/exec";
        const members = ["ä¸€è™Ÿ", "è©©æ½”", "Yuzugi", "å°ç‘œ", "è€æ", "æ ©ç¿”"];
        const daysData = [
            { id: 1, date: "3/13 (äº”)", color: "blue-600", items: [{ time: "09:30", text: "è½‰æ©Ÿçµ„æŠµé”æ–°åƒæ­²" }, { time: "11:00", text: "ç›´é£›çµ„æŠµé”æ–°åƒæ­²" }, { time: "13:00", text: "ç§Ÿè»Šä¸­å¿ƒå–è»Š" }, { time: "15:00", text: "æœ­å¹Œé£¯åº— Check-in" }]},
            { id: 2, date: "3/14 (å…­)", color: "blue-400", items: [{ time: "08:30", text: "æ—­å·å‹•ç‰©åœ’å‡ºç™¼" }, { time: "11:00", text: "ğŸ§ ä¼éµéŠè¡Œ" }, { time: "18:30", text: "ç¾ç‘›é’æ± å¤œé–“é»ç‡ˆ" }]},
            { id: 3, date: "3/15 (æ—¥)", color: "pink-500", items: [{ time: "08:00", text: "æœ­å¹Œæ·±åº¦éŠğŸ¦€ğŸ¦€ğŸ¦€" }]},
            { id: 4, date: "3/16 (ä¸€)", color: "emerald-500", items: [{ time: "08:00", text: "Kiroro æ»‘é›ªå ´é«”é©—" }, { time: "17:30", text: "å°æ¨½é‹æ²³æ•£æ­¥ã€æ™šé¤" }]},
            { id: 5, date: "3/17 (äºŒ)", color: "slate-700", items: [{ time: "10:00", text: "æœ­å¹Œå¸‚å€æœ€å¾Œè£œè²¨" }, { time: "16:00", text: "å‰å¾€æ©Ÿå ´ (é‚„è»Š)" }, { time: "18:40", text: "æ–°åƒæ­²èµ·é£› (TR893)" }]}
        ];


        let records = JSON.parse(localStorage.getItem('hokkaido_v1')) || [];
        let jpyRate = 0.21;

        // 1. åˆå§‹åŒ–ï¼šå–å¾—åŒ¯ç‡èˆ‡è‡ªå‹•ä¸‹è¼‰é›²ç«¯è³‡æ–™
        window.onload = () => {
            renderItinerary();
            fetch('https://open.er-api.com/v6/latest/JPY').then(r=>r.json()).then(d=> jpyRate = d.rates.TWD);
            downloadFromCloud(); // é–‹å•Ÿç¶²é è‡ªå‹•æ‹‰å–
        };

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active-tab'));
            document.getElementById(tabId).classList.add('active');
            document.getElementById('btn-' + tabId).classList.add('active-tab');
            if(tabId === 'splitting') renderSplitUI();
        }

        // --- é›²ç«¯åŠŸèƒ½ ---
        async function uploadToCloud() {
            const status = document.getElementById('sync-status');
            status.innerText = 'æ­£åœ¨å‚™ä»½...';
            try {
                await fetch(GAS_URL, { method: 'POST', body: JSON.stringify(records) });
                status.innerText = 'å·²åŒæ­¥: ' + new Date().toLocaleTimeString();
            } catch(e) { status.innerText = 'å‚™ä»½å¤±æ•—'; }
        }

        async function downloadFromCloud() {
            const status = document.getElementById('sync-status');
            status.innerText = 'åŒæ­¥ä¸­...';
            try {
                const r = await fetch(GAS_URL);
                const data = await r.json();
                if(data && data.length >= 0) {
                    records = data;
                    localStorage.setItem('hokkaido_v1', JSON.stringify(records));
                    calculateAllStat();
                    status.innerText = 'åŒæ­¥æˆåŠŸ: ' + new Date().toLocaleTimeString();
                }
            } catch(e) { status.innerText = 'åŒæ­¥å¤±æ•—'; }
        }

        // --- åˆ†å¸³åŠŸèƒ½ ---
        function renderSplitUI() {
            const area = document.getElementById('members-area');
            const datalist = document.getElementById('name-list');
            area.innerHTML = ''; datalist.innerHTML = '';
            members.forEach(m => {
                area.innerHTML += `<label class="bg-white border px-3 py-1 rounded-full text-[11px] flex items-center"><input type="checkbox" name="m-check" value="${m}" checked class="mr-1"> ${m}</label>`;
                datalist.innerHTML += `<option value="${m}">`;
            });
            calculateAllStat();
        }

        function addRecord() {
            const payer = document.getElementById('payer').value;
            let amount = parseFloat(document.getElementById('amount').value);
            const currency = document.getElementById('currency').value;
            const item = document.getElementById('item').value;
            const checked = Array.from(document.querySelectorAll('input[name="m-check"]:checked')).map(el => el.value);

            if(!payer || !amount || checked.length === 0) return alert('è«‹å®Œæ•´å¡«å¯«');

            // 2. æ—¥å¹£æé†’
            if(currency === 'JPY') {
                const twdValue = Math.ceil(amount * jpyRate);
                if(!confirm(`ã€æ—¥å¹£æé†’ã€‘\nåŒ¯ç‡ï¼š${jpyRate.toFixed(4)}\næ—¥å¹£ Â¥${amount} â” å°å¹£ ç´„ $${twdValue}\nç¢ºå®šä»¥å°å¹£ $${twdValue} è¨˜éŒ„ï¼Ÿ`)) return;
                amount = twdValue;
            }

            records.push({ payer, amount, item, members: checked, id: Date.now() });
            localStorage.setItem('hokkaido_v1', JSON.stringify(records));
            calculateAllStat();
            
            // 3. è‡ªå‹•ä¸Šå‚³å‚™ä»½
            uploadToCloud();
            
            document.getElementById('amount').value = ''; document.getElementById('item').value = '';
        }

        function calculateAllStat() {
            let balances = {}; let totalPaid = {};
            members.forEach(m => { balances[m] = 0; totalPaid[m] = 0; });
            const list = document.getElementById('history-list'); list.innerHTML = '';
            
            records.forEach(r => {
                const share = r.amount / r.members.length;
                totalPaid[r.payer] += r.amount;
                balances[r.payer] += r.amount;
                r.members.forEach(m => balances[m] -= share);
                list.innerHTML = `<div class="py-2 flex justify-between text-[11px]"><span>${r.payer}: ${r.item}</span><span class="font-bold text-blue-600">$${r.amount}</span></div>` + list.innerHTML;
            });

            // è£œå›ï¼šå¢Šä»˜è²¢ç»æ’è¡Œæ¦œ
            const rankDiv = document.getElementById('payment-summary'); rankDiv.innerHTML = '';
            const ranks = ["bg-yellow-400", "bg-gray-400", "bg-amber-600"];
            Object.entries(totalPaid).sort((a,b)=>b[1]-a[1]).forEach(([n, a], i) => {
                if(a === 0) return;
                rankDiv.innerHTML += `<div class="flex justify-between items-center"><span class="flex items-center"><span class="badge ${ranks[i] || 'bg-gray-200'}">${i+1}</span>${n}</span><span class="font-bold">$${Math.round(a)}</span></div>`;
            });

            // è£œå›ï¼šæœ€çµ‚æç›Š
            const pDiv = document.getElementById('personal-summary'); pDiv.innerHTML = '';
            for(let n in balances) {
                const b = Math.round(balances[n]);
                if(b!==0) pDiv.innerHTML += `<div class="flex justify-between"><span>${n}</span><span class="${b>0?'text-green-600':'text-red-500'} font-bold">${b>0?'æ‡‰æ”¶':'æ‡‰ä»˜'} $${Math.abs(b)}</span></div>`;
            }

            // æœ€çŸ­é‚„æ¬¾
            const planDiv = document.getElementById('settlement-plan'); planDiv.innerHTML = '';
            let d = [], c = [];
            for(let n in balances) {
                if(balances[n] < -1) d.push({n, amt: Math.abs(balances[n])});
                else if(balances[n] > 1) c.push({n, amt: balances[n]});
            }
            while(d.length && c.length) {
                d.sort((x,y)=>y.amt-x.amt); c.sort((x,y)=>y.amt-x.amt);
                let s = Math.min(d[0].amt, c[0].amt);
                planDiv.innerHTML += `<div class="flex justify-between bg-white p-2 rounded-lg text-[10px] shadow-sm"><span>${d[0].n} â” ${c[0].n}</span><span class="font-bold text-blue-600">$${Math.ceil(s)}</span></div>`;
                d[0].amt -= s; c[0].amt -= s;
                if(d[0].amt < 1) d.shift(); if(c[0].amt < 1) c.shift();
            }
        }

        function clearRecords() { if(confirm('æ¸…ç©ºæ‰€æœ‰æœ¬åœ°è³‡æ–™ï¼Ÿ')) { records = []; localStorage.removeItem('hokkaido_v1'); calculateAllStat(); uploadToCloud(); } }

        function toggleFlightGroup(group) {
            document.querySelectorAll('.flight-group').forEach(el => el.classList.remove('active'));
            document.getElementById('group-' + group).classList.add('active');
        }

        function renderItinerary() {
            const list = document.getElementById('itinerary-list');
            if(!list) return;
            list.innerHTML = '';
            daysData.forEach(day => {
                const dDiv = document.createElement('div');
                dDiv.className = `border-l-4 border-${day.color} pl-4 mb-8`;
                dDiv.innerHTML = `<h4 class="font-black text-${day.color} mb-4">${day.date}</h4>` + 
                    day.items.map(i => `<div class="flex space-x-3 mb-2 text-sm"><span class="font-bold text-gray-400">${i.time}</span><span>${i.text}</span></div>`).join('');
                list.appendChild(dDiv);
            });
        }
// åŸæœ‰èˆªç­èˆ‡è¡Œç¨‹ JS
        function toggleFlightGroup(group) {
            document.querySelectorAll('.flight-group').forEach(el => el.classList.remove('active'));
            document.getElementById('group-' + group).classList.add('active');
            const btns = [document.getElementById('btn-direct'), document.getElementById('btn-transfer')];
            btns.forEach(b => b.classList.remove('bg-white', 'shadow-sm', 'text-blue-600'));
            btns.forEach(b => b.classList.add('text-gray-500'));
            const activeBtn = document.getElementById('btn-' + group);
            activeBtn.classList.add('bg-white', 'shadow-sm', 'text-blue-600');
            activeBtn.classList.remove('text-gray-500');
        }

        function renderItinerary() {
            const list = document.getElementById('itinerary-list');
            if (!list) return;
            list.innerHTML = '';
            daysData.forEach((day, dayIdx) => {
                day.items.sort((a, b) => a.time.localeCompare(b.time));
                const dayDiv = document.createElement('div');
                dayDiv.className = `day-group border-l-4 border-${day.color} pl-4 relative`;
                dayDiv.innerHTML = `<div class="flex justify-between items-center mb-4"><h4 class="font-black text-${day.color} text-lg">${day.date} ç¬¬${day.id}å¤©</h4><button onclick="addItem(${dayIdx})" class="text-[11px] bg-${day.color.split('-')[0]}-50 text-${day.color} px-3 py-1.5 rounded-full font-bold shadow-sm">+ æ–°å¢è¡Œç¨‹</button></div><div class="schedule-items space-y-3">${day.items.map((item, itemIdx) => `<div class="schedule-item group flex justify-between items-start border-b border-gray-50 pb-2 hover:bg-gray-50 rounded px-1"><div class="flex space-x-3 items-start"><span class="text-xs font-black text-gray-400 mt-1.5 min-w-[45px]">${item.time}</span><span class="text-sm font-medium py-1">${item.text}</span></div><button onclick="deleteItem(${dayIdx}, ${itemIdx})" class="text-gray-300 hover:text-red-500 p-1 opacity-0 group-hover:opacity-100 transition-opacity"><svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-4v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button></div>`).join('')}</div>`;
                list.appendChild(dayDiv);
            });
        }

        function addItem(dayIdx) {
            const time = prompt("æ™‚é–“ (HH:MM):", "12:00");
            if (!time) return;
            const text = prompt("å…§å®¹:", "æ–°è¡Œç¨‹");
            if (!text) return;
            daysData[dayIdx].items.push({ time, text });
            renderItinerary();
        }

        function deleteItem(dayIdx, itemIdx) {
            if (confirm("ç¢ºå®šåˆªé™¤ï¼Ÿ")) { daysData[dayIdx].items.splice(itemIdx, 1); renderItinerary(); }
        }

        window.onload = () => { renderItinerary(); };
    </script>
</body>
</html>
